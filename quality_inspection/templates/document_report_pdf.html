<head>
    <link href="{{ frappe.get_url() }}/assets/frappe/css/bootstrap.css" rel="stylesheet">
    {{ include_style('print.bundle.css') }}
</head>

<body>
    {% if doc|length > 0 %}

    <div style="font-size: 20px !important;">
        <table class="table table-bordered" style="table-layout: fixed;">
            <tr>
                <td colspan="6" class="text-center" style="vertical-align: middle;">
                    <h1><b>{{doc.name}}</b></h1>
                </td>
            </tr>
            <tr>
                <td colspan="2" class="text-center">
                    <h2><b>Inspection Date: </b>{{doc.date_of_inspection}}</h2>
                </td>
                <td colspan="2" class="text-center">
                    <h2><b>Vendor: </b>{{doc.vendor}}</h2>
                </td>
                <td colspan="2" class="text-center">
                    <h2><b>Flooring Class: </b>{{doc.flooring_class}}</h2>
                </td>
            </tr>
            <tr>
                <td colspan="6" class="text-center">
                    <h2>
                        <b> PO Reference:</b>
                        {% for item in doc.pallet_details %}
                        {{ item.tas_po }}{% if loop.index != doc.pallet_details|length %},{%endif%}
                        {% endfor %}
                    </h2>
                </td>
            </tr>
        </table>

        <div style="page-break-before:always">&nbsp;</div>

        <table class="table table-bordered" style="table-layout: fixed;">
            <tr>
                <td class="text-left" style="vertical-align: middle; font-size: 20px">
                    <b>GLOSS LEVEL</b>
                </td>
                <td>
                    <div class="row" style="font-size: 20px">
                        <div class="col-xs-7 text-right">
                            <b>Result: </b>
                        </div>
                        <div class="col-xs-5">
                            {% set fail_ration = 100 - (doc.gloss_todo_ratio + doc.gloss_pass_ration +
                            doc.gloss_undetermined_ratio) %}
                            <span><b>ToDo :</b> {{doc.gloss_todo_ratio}} % </span> <br>
                            <span><b>Pass :</b> {{doc.gloss_pass_ration}} % </span><br>
                            <span><b>Undetermined :</b> {{doc.gloss_undetermined_ratio}} % </span><br>
                            <span><b>Fail :</b> {{ " %.2f " | format(fail_ration) }} % </span> <br>
                        </div>
                    </div>
                </td>
            </tr>

            <tr>
                <td>
                    <h2><a href="#attachments">Attachments</a></h2>
                    <!-- <h2><a href="" name="attachments">Attachments</a></h2> -->
                </td>
                <td>
                    <h2>
                        Equipement In Use:
                        {% for equip in doc.gloss_equipment %}
                        {{equip.equipment}}{% if loop.index != doc.gloss_equipment|length %},{%endif%}
                        {% endfor %}
                    </h2>
                </td>
            </tr>

            {% for i in range(doc.no_of_po) %}
            {% set tas_po = "po_gloss_" + (i+1)|string %}
            {% set table_name = "gloss_level_details_" + (i+1)|string %}
            <tr style="background-color: #D1D8BE;">
                <td colspan="2">
                    {{doc[tas_po]}}
                </td>
            </tr>
            {% for item in doc[table_name]%}
                <!-- <tr>
                        <td colspan="2">
                            {{ item.item_color }}
                        </td>
                    </tr> -->

                    <tr>
                        <td colspan="2">
                            <!-- <h2>Sample Details</h2> -->
                             <p>{{ item.item_color }}</p>
                            <table class="table table-bordered">
                                <thead>
                                    <th class="text-center" width=12%>Master Sample</th>
                                    <th colspan="2" class="text-center" width=17.6%>Matched</th>
                                    <th colspan="2" class="text-center" width=17.6%>Highest Matched</th>
                                    <th colspan="2" class="text-center" width=17.6%>Lowest Matched</th>
                                    <th colspan="2" class="text-center" width=17.6%>Average Plank 1</th>
                                    <th colspan="2" class="text-center" width=17.6%>Average Plank 2</th>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>{{item.master_gl}}</td>
                                        <td width=5%>{{item.fb_gl_1}}</td>
                                        <td>{{item.results_select_1}}</td>
                                        <td width=5%>{{item.fb_gl_2}}</td>
                                        <td>{{item.results_select_2}}</td>
                                        <td width=5%>{{item.fb_gl_3}}</td>
                                        <td>{{item.results_select_3}}</td>
                                        <td width=5%>{{item.fb_gl_4}}</td>
                                        <td>{{item.results_select_4}}</td>
                                        <td width=5%>{{item.fb_gl_5}}</td>
                                        <td>{{item.results_select_5}}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </td>
                    </tr>
            {% endfor %}

        {% endfor %}
        </table>

        <div style="page-break-before:always">&nbsp;</div>
        <div id="attachments">
            <h2><b>Photos: </b></h2>
            <div class="row">
            {% for i in range(doc.no_of_po) %}
            {% set tas_po = "po_gloss_" + (i+1)|string %}
            {% set table_name = "gloss_level_details_" + (i+1)|string %}
            
            {% for item in doc[table_name]%}
                
                {% if item.master_sample %}
                <div class="col-xs-4 text-center" style="padding: 5px;">
                    <img src="{{ frappe.get_url() }}/{{item.master_sample or ''}}" alt="gloss-level" width="300px" height="auto" class="img-responsive"><br>
                    <p>Gloss Level</p>
                </div>
                {% endif %}

                {% if item.finished_board_1 %}
                <div class="col-xs-4 text-center" style="padding: 5px;">
                    <img src="{{ frappe.get_url() }}/{{item.finished_board_1 or ''}}" alt="gloss-level" width="300px" height="auto" class="img-responsive"><br>
                    <p>Gloss Level</p>
                </div>
                {% endif %}

                {% if item.finished_board_2 %}
                <div class="col-xs-4 text-center" style="padding: 5px;">
                    <img src="{{ frappe.get_url() }}/{{item.finished_board_2 or ''}}" alt="gloss-level" width="300px" height="auto" class="img-responsive"><br>
                    <p>Gloss Level</p>
                </div>
                {% endif %}

                {% if item.finished_board_3 %}
                <div class="col-xs-4 text-center" style="padding: 5px;">
                    <img src="{{ frappe.get_url() }}/{{item.finished_board_3 or ''}}" alt="gloss-level" width="300px" height="auto" class="img-responsive"><br>
                    <p>Gloss Level</p>
                </div>
                {% endif %}

                {% if item.finished_board_4 %}
                <div class="col-xs-4 text-center" style="padding: 5px;">
                    <img src="{{ frappe.get_url() }}/{{item.finished_board_4 or ''}}" alt="gloss-level" width="300px" height="auto" class="img-responsive"><br>
                    <p>Gloss Level</p>
                </div>
                {% endif %}

                {% if item.finished_board_5 %}
                <div class="col-xs-4 text-center" style="padding: 5px;">
                    <img src="{{ frappe.get_url() }}/{{item.finished_board_5 or ''}}" alt="gloss-level" width="300px" height="auto" class="img-responsive"><br>
                    <p>Gloss Level</p>
                </div>
                {% endif %}
                    
            {% endfor %}   
        {% endfor %}
        </div>
        </div>

        {% endif %}
    </div>



</body>